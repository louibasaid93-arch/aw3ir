<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Météo App</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.css">
    
    <!-- Weather Icons CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.12/css/weather-icons.min.css">
</head>
<body>
    <div id="weatherApp" class="container mt-5">
        <h1 class="mb-4">☀️ Application Météo</h1>
        
        <!-- Formulaire de saisie de ville -->
        <form v-on:submit="addCity" class="mb-4">
            <div class="input-group">
                <input
                    type="search"
                    class="form-control"
                    v-model="formCityName"
                    placeholder="Entrez le nom d'une ville..."
                    aria-label="Search for..."
                    autofocus
                    required
                />
                <span class="input-group-btn">
                    <button class="btn btn-primary" type="submit">Go!</button>
                </span>
            </div>
            
            <!-- Affichage du nombre de caractères -->
            <small class="text-muted">{{formCityName.length}} car.</small>
            
            <!-- Message d'erreur -->
            <div class="alert alert-danger mt-2" role="alert" v-if='messageForm != ""'>
                {{messageForm}}
            </div>
        </form>
        <!-- Fin formulaire -->
        
        <!-- Liste des villes -->
        <h4>Liste des villes ({{cityList.length}})</h4>
        <ul class="list-group mb-4">
            <a
                v-for="city in cityList"
                v-on:click="meteo(city)"
                class="list-group-item d-flex justify-content-between align-items-center"
                style="cursor: pointer;"
            >
                {{city.name}}
                <button
                    v-on:click.stop="remove(city)"
                    class="btn btn-secondary btn-sm"
                    title="Supprimer de la liste"
                >
                    &times;
                </button>
            </a>
        </ul>
        
        <div class="alert alert-primary" role="alert" v-if="cityList.length==0">
            Aucune ville saisie !
        </div>
        <!-- Fin liste des villes -->
        
        <!-- Message général -->
        <div class="alert alert-warning" role="alert" v-if="message">
            {{message}}
        </div>
        
        <!-- Chargement météo -->
        <div v-if="cityWeatherLoading" class="text-center">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Chargement...</span>
            </div>
            <p>Chargement de la météo...</p>
        </div>
        
        <!-- Carte météo -->
        <div v-if="cityWeather" class="row">
            <div class="col-md-6 mx-auto">
                <div class="card">
                    <div class="card-header">
                        <strong>{{cityWeather.name}}, {{cityWeather.sys.country}}</strong> 
                        @ {{cityWheaterDate}}
                    </div>
                    
                    <!-- Carte OpenStreetMap -->
                    <iframe
                        class="card-img-top"
                        alt="Carte de la ville"
                        width="100%"
                        height="200"
                        frameborder="0"
                        scrolling="no"
                        v-bind:src="'https://www.openstreetmap.org/export/embed.html?bbox=' + openStreetMapArea + '&layer=mapnik&marker=' + cityWeather.coord.lat + '%2C' + cityWeather.coord.lon"
                    >
                    </iframe>
                    
                    <div class="card-body text-center">
                        <h5 class="card-title">
                            <i v-bind:class="'wi wi-owm-day-'+cityWeather.weather[0].id"></i>
                            {{cityWeather.main.temp}}°C
                        </h5>
                        <p class="card-text">{{cityWeather.weather[0].description}}</p>
                    </div>
                    
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <i class="wi wi-cloud"></i> 
                            Nuage: {{cityWeather.clouds.all}}%
                        </li>
                        <li class="list-group-item">
                            <i class="wi wi-humidity"></i> 
                            Humidité: {{cityWeather.main.humidity}}%
                        </li>
                        <li class="list-group-item">
                            <i class="wi wi-windy"></i> 
                            Vent: {{cityWeather.wind.speed}} km/h
                        </li>
                        <li class="list-group-item">
                            <i class="wi wi-sunrise"></i> 
                            Levé du soleil: {{cityWheaterSunrise}}
                        </li>
                        <li class="list-group-item">
                            <i class="wi wi-sunset"></i> 
                            Couché du soleil: {{cityWheaterSunset}}
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- Fin carte météo -->
    </div>
    
    <!-- Scripts -->
    <script src="js/libs/vue.js"></script>
    <script src="js/libs/bootstrap.bundle.js"></script>
    <script src="js/main.js"></script>
</body>
</html>